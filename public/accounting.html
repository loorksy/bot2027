<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุธุงู ุงููุญุงุณุจุฉ ุงููุจุณุท</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body style="margin: 0; background: #0f0f1a; color: #fff; font-family: 'Segoe UI', sans-serif;">

    <div style="max-width: 1200px; margin: 0 auto; padding: 20px;">

        <!-- DASHBOARD (CYCLES LIST) -->
        <div id="page-dashboard">
            <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h1>ุงูุฏูุฑุงุช ุงููุญุงุณุจูุฉ</h1>
                <div>
                    <button class="btn btn-secondary" onclick="showSubAgencies()">๐ข ุงูููุงูุงุช ุงููุฑุนูุฉ</button>
                    <button class="btn btn-secondary" onclick="showMainAgency()">๐ค ุงูููุงูุฉ ุงูุฑุฆูุณูุฉ</button>
                    <button class="btn btn-primary" onclick="openCreateModal()">+ ุฏูุฑุฉ ุฌุฏูุฏุฉ</button>
                </div>
            </header>

            <div class="ai-card">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ุงุณู ุงูุฏูุฑุฉ</th>
                            <th>ุงูุชุงุฑูุฎ</th>
                            <th>ุงูุญุงูุฉ</th>
                            <th>ุฅุฌุฑุงุก</th>
                        </tr>
                    </thead>
                    <tbody id="cycles-list">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- DETAILS (REPORT VIEW) -->
        <div id="page-details" style="display: none;">
            <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <div>
                    <button class="btn btn-secondary btn-sm" onclick="showDashboard()">ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</button>
                    <h2 id="detail-title" style="margin-top: 10px;">-</h2>
                </div>
            </header>

            <!-- Simple Tabs -->
            <div style="margin-bottom: 20px; border-bottom: 1px solid #333; display: flex; gap: 10px;">
                <button class="tab-btn active" onclick="switchTab('soulchill')" id="btn-soulchill">ุจูุงูุงุช ุงูุฅุฏุงุฑุฉ
                    (Soulchill)</button>
                <button class="tab-btn" onclick="switchTab('agent')" id="btn-agent">ุจูุงูุงุช ุงููููู (Agent)</button>
            </div>

            <!-- TAB 1: Soulchill Data -->
            <div id="tab-soulchill">
                <div class="ai-card">
                    <h3>ุชูุฑูุฑ ุงูุฅุฏุงุฑุฉ ุงููุณุชูุฑุฏ</h3>
                    <p class="muted">ููุง ุชุธูุฑ ุงูุจูุงูุงุช ุงููุณุชูุฑุฏุฉ ูู ุดูุช ุงูุฅุฏุงุฑุฉ (ุฃุฑุจุงุญ ุงูููุงูุฉ).</p>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ุงููุณุชุฎุฏู</th>
                                <th>Agency Profit (W)</th>
                                <th>Week Bonus (Y)</th>
                                <th>Month Bonus (Z)</th>
                                <th>Total Profit</th>
                            </tr>
                        </thead>
                        <tbody id="list-soulchill">
                            <tr>
                                <td colspan="5" class="text-center muted">ูุง ุชูุฌุฏ ุจูุงูุงุช (ูุฑุฌู ุงูุฑูุน)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- TAB 2: Agent Data -->
            <div id="tab-agent" style="display: none;">
                <div class="ai-card">
                    <h3>ุชูุฑูุฑ ุงููููู ุงููุณุชูุฑุฏ</h3>
                    <p class="muted">ููุง ุชุธูุฑ ุงูุจูุงูุงุช ุงููุณุชูุฑุฏุฉ ูู ุดูุช ุงููููู (ุงูุฑูุงุชุจ + ูุณุจุฉ ุงูุชุญููู).</p>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ุงููุณุชุฎุฏู</th>
                                <th>ุงูุฑุงุชุจ (Net)</th>
                                <th>ูุณุจุฉ ุงูุชุญููู (7%)</th>
                                <th>ุงูุฅุฌูุงูู</th>
                            </tr>
                        </thead>
                        <tbody id="list-agent">
                            <tr>
                                <td colspan="4" class="text-center muted">ูุง ุชูุฌุฏ ุจูุงูุงุช (ูุฑุฌู ุงูุฑูุน)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- PAGE: MAIN AGENCY USERS -->
        <div id="page-main-agency" style="display: none;">
            <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <div>
                    <button class="btn btn-secondary btn-sm" onclick="showDashboard()">ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</button>
                    <h2 style="display:inline-block; margin:0 10px;">๐ค ูุณุชุฎุฏูู ุงูููุงูุฉ ุงูุฑุฆูุณูุฉ</h2>
                </div>
                <div>
                    <button class="btn btn-secondary btn-sm" onclick="openImportUsersModal(true, 'Main')">๐ ุงุณุชูุฑุงุฏ
                        (CSV)</button>
                    <button class="btn btn-primary btn-sm" onclick="openAddUserModal('Main')">+ ุฅุถุงูุฉ ูุณุชุฎุฏู</button>
                </div>
            </header>
            <div class="ai-card">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>ุงูุงุณู</th>
                            <th>ุงูุฏููุฉ</th>
                            <th>ุงููุงุชู</th>
                            <th>ุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="main-users-list"></tbody>
                </table>
            </div>
        </div>

        <!-- PAGE: SUB-AGENCIES GRID -->
        <div id="page-sub-agencies" style="display: none;">
            <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <div>
                    <button class="btn btn-secondary btn-sm" onclick="showDashboard()">ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</button>
                    <h2 style="display:inline-block; margin:0 10px;">๐ข ุงูููุงูุงุช ุงููุฑุนูุฉ</h2>
                </div>
                <button class="btn btn-primary" onclick="openAddAgencyModal()">+ ุฅุถุงูุฉ ููุงูุฉ ุฌุฏูุฏุฉ</button>
            </header>

            <div id="agencies-grid"
                style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px;">
                <!-- JS Populated Cards -->
            </div>
        </div>

        <!-- PAGE: AGENCY PROFILE (DETAILS) -->
        <div id="page-agency-profile" style="display: none;">
            <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <div>
                    <button class="btn btn-secondary btn-sm" onclick="showSubAgencies()">ุงูุนูุฏุฉ ูููุงุฆูุฉ</button>
                    <h2 id="profile-agency-name" style="display:inline-block; margin:0 10px;">Agency Name</h2>
                </div>
                <div>
                    <button class="btn btn-red btn-sm" onclick="deleteAgency()">ุญุฐู ุงูููุงูุฉ</button>
                </div>
            </header>

            <div class="ai-card" style="margin-bottom: 20px; padding: 15px;">
                <div style="display: flex; gap: 20px;">
                    <div><strong>ุนุฏุฏ ุงููุณุชุฎุฏููู:</strong> <span id="profile-user-count">0</span></div>
                    <div><strong>ุงููุณุจุฉ:</strong> <span id="profile-ratio">10%</span></div>
                </div>
            </div>

            <div class="ai-card">
                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                    <h3>ุงููุณุชุฎุฏููู</h3>
                    <div>
                        <button class="btn btn-secondary btn-sm" onclick="openImportUsersModal(true, currentAgency)">๐
                            ุงุณุชูุฑุงุฏ (CSV)</button>
                        <button class="btn btn-primary btn-sm" onclick="openAddUserModal(currentAgency)">+ ุฅุถุงูุฉ
                            ูุณุชุฎุฏู</button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>ุงูุงุณู</th>
                            <th>ุงูุฏููุฉ</th>
                            <th>ุงููุงุชู</th>
                            <th>ุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="profile-users-list"></tbody>
                </table>
            </div>
        </div>

    </div>

    <!-- MODAL: Add Agency -->
    <div id="modal-add-agency" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 400px;">
            <h3>ุฅุถุงูุฉ ููุงูุฉ ูุฑุนูุฉ</h3>
            <div class="form-group">
                <label>ุงุณู ุงูููุงูุฉ</label>
                <input type="text" id="inp-agency-name">
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('modal-add-agency')">ุฅูุบุงุก</button>
                <button class="btn btn-primary" onclick="addAgency()">ุฅุถุงูุฉ</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Add User -->
    <div id="modal-add-user" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 400px;">
            <h3>ุฅุถุงูุฉ ูุณุชุฎุฏู ุฌุฏูุฏ</h3>
            <div class="form-group">
                <label>ID (ุฑูู ุงููุณุชุฎุฏู)</label>
                <input type="text" id="inp-user-id" placeholder="ูุซุงู: 123456">
            </div>
            <div class="form-group">
                <label>ุงูุงุณู ุงููุงูู</label>
                <input type="text" id="inp-user-name">
            </div>
            <div class="form-group">
                <label>ุงูููุงูุฉ</label>
                <input type="text" id="inp-user-agency" disabled style="background: #333; color: #aaa;">
            </div>
            <div class="form-group">
                <label>ูุนูููุงุช ุฅุถุงููุฉ (ุงูุฏููุฉ)</label>
                <input type="text" id="inp-user-country">
            </div>

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('modal-add-user')">ุฅูุบุงุก</button>
                <button class="btn btn-primary" onclick="addUser()">ุญูุธ</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Create Cycle (Existing) -->
    <div id="modal-create" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>ุฅูุดุงุก ุฏูุฑุฉ ุฌุฏูุฏุฉ</h2>

            <div class="form-group">
                <label>ุงุณู ุงูุฏูุฑุฉ (ูุซุงู: JAN-2026-WK1)</label>
                <input type="text" id="inp-name" style="width: 100%; padding: 10px;">
            </div>

            <div style="margin: 20px 0; background: #222; padding: 15px; border-radius: 5px;">
                <div class="form-group">
                    <label>ุฑูุน ุดูุช ุงูุฅุฏุงุฑุฉ (Soulchill):</label>
                    <input type="file" id="file-soulchill" accept=".csv">
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label>ุฑูุน ุดูุช ุงููููู (Agent):</label>
                    <input type="file" id="file-agent" accept=".csv">
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal()">ุฅูุบุงุก</button>
                <button class="btn btn-primary" onclick="createCycle()">ุฅูุดุงุก ูุฑูุน</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Import Users -->
    <div id="modal-import-users" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 400px;">
            <h2>ุงุณุชูุฑุงุฏ ูุงุนุฏุฉ ุจูุงูุงุช ุงููุณุชุฎุฏููู</h2>
            <div class="form-group">
                <label>ููู ุงููุณุชุฎุฏููู (CSV)</label>
                <input type="file" id="file-users-db" accept=".csv">
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModalUsers()">ุฅูุบุงุก</button>
                <button class="btn btn-primary" onclick="importUsers()">ุฑูุน ูุชุญุฏูุซ</button>
            </div>
        </div>
    </div>

    <script src="accounting.js"></script>
</body>

</html>